/*
 * VASensors.c
 *
 *  Created on: Feb 6, 2023
 *      Author: Liam Sullivan
 *
 *  Description:
 *
 */

#include "VASensors.h"

ADC_ChannelConfTypeDef sConfig = {0};

void start_va_sensors(ADC_HandleTypeDef* adc_handle){
	HAL_StatusTypeDef ret;

	// Select pH Channel
	adc_select_pH();
	// Start the collection of Values from the ADC
	ret = HAL_ADC_Start(adc_handle);
	// Poll for a conversion


}


void adc_select_pH(void){
	// Create the ADC channel configuration
	ADC_ChannelConfTypeDef sConfig = {0};

	// Populate the configuration to select channel 3 (pH Sensor)
	sConfig.Channel = ADC_CHANNEL_3;
    sConfig.Rank = ADC_REGULAR_RANK_1;
    sConfig.SamplingTime = ADC_SAMPLETIME_92CYCLES_5;

    // Configure the adc to select channel 3
    if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
    {
	  Error_Handler();
    }
}

void adc_select_salinity(void){
	// Create the ADC channel configuration
	ADC_ChannelConfTypeDef sConfig = {0};

	// Populate the configuration to select channel 3 (pH Sensor)
	sConfig.Channel = ADC_CHANNEL_5;
    sConfig.Rank = ADC_REGULAR_RANK_1;
    sConfig.SamplingTime = ADC_SAMPLETIME_92CYCLES_5;

    // Configure the adc to select channel 3
    if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
    {
	  Error_Handler();
    }
}

void adc_select_dissolved_oxygen(void){
	// Create the ADC channel configuration
	ADC_ChannelConfTypeDef sConfig = {0};

	// Populate the configuration to select channel 3 (pH Sensor)
	sConfig.Channel = ADC_CHANNEL_7;
    sConfig.Rank = ADC_REGULAR_RANK_1;
    sConfig.SamplingTime = ADC_SAMPLETIME_92CYCLES_5;

    // Configure the adc to select channel 3
    if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
    {
	  Error_Handler();
    }
}


